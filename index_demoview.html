<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visionary</title>
    <style>
        html,body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <!-- <iframe id="visionaryFrame" src="http://localhost:8901/index_visionary.html" width="100%" height="100%"
        allow="file-system-access" style="border: none;">
    </iframe> -->
    <iframe id="visionaryFrame" src="https://ai4sports.opengvlab.com/index_visionary.html" width="100%" height="100%"
        allow="file-system-access" style="border: none;">
    </iframe>
    <script src="/scripts/iframeassist.js"></script>
    <script>
        // 页面加载后获取 URL 和参数
        window.addEventListener('DOMContentLoaded', () => {
            // 获取完整 URL
            const fullUrl = window.location.href;
            console.log('完整 URL:', fullUrl);

            // 获取 URL 参数
            const urlParams = new URLSearchParams(window.location.search);
            let iframeSrc = 'https://ai4sports.opengvlab.com';
            // let iframeSrc = 'http://localhost:8901';
            console.log('urlParams:', urlParams, urlParams.get('scene'), urlParams.get('scene') ? true : false);
            if (urlParams.get('scene')) {
                console.log('场景:', urlParams.get('scene'));
                iframeSrc += `/index_demoview.html?scene=${urlParams.get('scene')}`;
                const iframe = document.getElementById('visionaryFrame');
                iframe.src = iframeSrc;
            } else {
                console.log('没有场景参数');

                window.location.href = 'https://ai4sports.opengvlab.com/index_visionary.html';
            }
        });

        // 获取 iframe 元素
        const iframe = document.getElementById('visionaryFrame');

        // 初始化 iframe 文件系统代理助手
        const iframeFileSystemAssist = new IframeFileSystemAssist(iframe);

        // 可选：定期清理过期的 handle（每小时清理一次）
        setInterval(() => {
            iframeFileSystemAssist.cleanupExpiredHandles(3600000); // 1小时
        }, 3600000);
    </script>
</body>

</html>